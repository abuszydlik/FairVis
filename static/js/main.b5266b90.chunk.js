(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{170:function(e,t,a){e.exports=a.p+"static/media/compas_high_class_cluster.335219ea.csv"},245:function(e,t,a){e.exports=a(425)},250:function(e,t,a){},251:function(e,t,a){},258:function(e,t){},259:function(e,t){},266:function(e,t,a){},345:function(e,t,a){},387:function(e,t,a){},417:function(e,t,a){},425:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(38),i=a.n(s),c=(a(250),a(29)),l=a(33),o=a(35),u=a(34),p=a(36),d=a(105),h=a.n(d),f=a(56),m=a.n(f),v=a(104),g=a.n(v),b=a(26),E=a(106),y=a.n(E),k=a(41),x=a.n(k),S=a(182),O=a.n(S),j=a(16),w=a(170),C=a.n(w),N=(a(251),a(30));function G(e,t,a,n,r){var s=new Map,i=Object.keys(t);return e.forEach(function(e){var a="",n=[],r=!0;if(i.forEach(function(s){var i=e[s];t[s].includes(i)||0===t[s].length?(n.push(i),a+=i+", "):r=!1}),r){a=a.slice(0,-2);var c=s.get(a);void 0===c?s.set(a,{vals:n,insts:[e]}):(c.insts.push(e),s.set(a,c))}}),function(e,t,a,n,r){var s=[],i=t;return e.forEach(function(e,t){var c=M(e.insts),l=function(e,t,a){var n={};t.forEach(function(e,t){var r=a[t],s={};r.forEach(function(e,t){s[e]=0}),n[e]=s}),e.forEach(function(e,t){Object.entries(e).forEach(function(e){n[e[0]][e[1]]+=1})});var r=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),s=[];return t.forEach(function(e){var t=Object.entries(n[e]);t.sort(function(e,t){return r.compare(e[0],t[0])}),s.push(t)}),s}(e.insts,n,r);s.push({id:i,feats:a,vals:e.vals,insts:e.insts,metrics:c,type:"top",distrib:l}),i++}),s}(s,a,i,n,r)}function M(e){var t=function(e){var t=0,a=0,n=0,r=0,s=0,i=0;return e.forEach(function(e){var c=Math.round(parseFloat(e.out)),l=parseInt(e.class,10);1===c&&1===l?(n++,t++):0===c&&0===l?(r++,a++):1===c&&0===l?(s++,a++):(i++,t++)}),{p:t,n:a,tp:n,tn:r,fp:s,fn:i}}(e),a={size:e.length,p:100*t.p/e.length,n:100*t.n/e.length,acc:100*(t.tp+t.tn)/(t.p+t.n),rec:100*t.tp/(t.tp+t.fn),spec:100*t.tn/(t.fp+t.tn),prec:100*t.tp/(t.tp+t.fp),npv:100*t.tn/(t.tn+t.fn),fnr:100*t.fn/(t.fn+t.tp),fpr:100*t.fp/(t.fp+t.tn),fdr:100*t.fp/(t.fp+t.tp),for:100*t.fn/(t.fn+t.tn),f1:200*t.tp/(2*t.tp+t.fp+t.fn)};return Object.keys(a).forEach(function(e){isNaN(a[e])&&(a[e]=0)}),a}function z(e,t,a){var n=Object.keys(e[0]);n.splice(n.indexOf("class"),1),n.splice(n.indexOf("out"),1),n.splice(n.indexOf("cluster"),1);var r={};n.forEach(function(t){var a=new Set(e.map(function(e){return e[t]}));r[t]=a});var s=[];e.forEach(function(e){-1!==e.cluster&&(null==s[e.cluster]?s[e.cluster]=[e]:s[e.cluster]=[].concat(Object(N.a)(s[e.cluster]),[e]))});var i=[];s.forEach(function(e,t){i[t]={};var a=i[t];a.size=e.length,n.forEach(function(t){a[t]={};var n=a[t];e.forEach(function(e){n[e[t]]=n[e[t]]?n[e[t]]+1:1})})});var c=[];i.forEach(function(e,t){c[t]={};var a=c[t],r=i[t],s=r.size;n.forEach(function(e){a[e]=function(e,t){var a=0;return Object.keys(e).forEach(function(n){e[n]=e[n]/t;var r=e[n];0!==r&&(a+=r*Math.log2(r))}),-a}(r[e],s)})});var l=[];return c.forEach(function(e,t){var a=Object.keys(e).sort(function(t,a){return e[t]-e[a]}),n=i[t],r=a.map(function(e){var t=n[e];return Object.keys(t).reduce(function(e,a){return t[e]<t[a]?e:a})});l[t]={feats:a,clusterid:t,vals:r,insts:s[t],metrics:M(s[t]),distrib:i[t],type:"bottom"}}),l}var D="#5a6d94",P="#d6d6d6",T=[{label:"Accuracy",value:"acc",key:"acc"},{label:"Precision",value:"prec",key:"prec"},{label:"Recall",value:"rec",key:"rec"},{label:"Specificity",value:"spec",key:"spec"},{label:"Negative Predictive Value",value:"npv",key:"npv"},{label:"False Negative Rate",value:"fnr",key:"fnr"},{label:"False Positive Rate",value:"fpr",key:"fpr"},{label:"False Discovery Rate",value:"fdr",key:"fdr"},{label:"False Omission Rate",value:"for",key:"for"},{label:"F1",value:"f1",key:"f1"}],L=function(){function e(e){var t=function(e){var t=0,a=0,n=0,r=0,s=0,i=0;return e.forEach(function(e){var c=Math.round(parseFloat(e.out)),l=parseInt(e.class,10);1===c&&1===l?(n++,t++):0===c&&0===l?(r++,a++):1===c&&0===l?(s++,a++):(i++,t++)}),{p:t,n:a,tp:n,tn:r,fp:s,fn:i}}(e),a={size:e.length,p:100*t.p/e.length,n:100*t.n/e.length,acc:100*(t.tp+t.tn)/(t.p+t.n),rec:100*t.tp/(t.tp+t.fn),spec:100*t.tn/(t.fp+t.tn),prec:100*t.tp/(t.tp+t.fp),npv:100*t.tn/(t.tn+t.fn),fnr:100*t.fn/(t.fn+t.tp),fpr:100*t.fp/(t.fp+t.tn),fdr:100*t.fp/(t.fp+t.tp),for:100*t.fn/(t.fn+t.tn),f1:200*t.tp/(2*t.tp+t.fp+t.fn)};return Object.keys(a).forEach(function(e){isNaN(a[e])&&(a[e]=0)}),a}self.addEventListener("message",function(t){var a={},n=t.data;a.data=n,a.avgs=e(n),a.feats=Object.keys(n[0]);for(var r=[],s=function(e){var t=new Set(n.map(function(t){return t[a.feats[e]]})),s=Array.from(t);r.push(s)},i=0;i<a.feats.length;i++)s(i);a.vals=r;var c=function(e,t,a){var n={};return t.forEach(function(e,t){var r=a[t],s={};r.forEach(function(e,t){s[e]=0}),n[e]=s}),e.forEach(function(e,t){Object.entries(e).forEach(function(e){n[e[0]][e[1]]+=1})}),n}(n,a.feats,a.vals),l=[],o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});a.feats.forEach(function(e){var t=Object.entries(c[e]);t.sort(function(e,t){return o.compare(e[0],t[0])}),l.push(t)}),a.distrib=l,postMessage(a)})},B=function e(t){Object(c.a)(this,e);var a=t.toString(),n=new Blob(["("+a+")()"]);return new Worker(URL.createObjectURL(n))},R=a(64),I=a.n(R),F=a(65),A=a.n(F),H=a(43),U=a.n(H),W=a(57),V=a.n(W),_=a(23),q=a.n(_),$=a(97),J=a.n($),Y=a(47),K=a.n(Y),Q=a(58),X=a.n(Q),Z=a(75),ee=a.n(Z),te={$schema:"https://vega.github.io/schema/vega-lite/v3.json",mark:"bar",width:250,transform:[{calculate:"datum.val/100",as:"percent"}],encoding:{y:{field:"name",type:"ordinal",axis:{title:"",labelFontSize:13,labelPadding:10}},x:{field:"percent",aggregate:"sum",type:"quantitative",axis:{title:"Ground Truth Label Balance",format:"%"}},color:{field:"color",type:"nominal",scale:{domain:["hovpos","hovneg","clickpos","clickneg"],range:["#64b5f6","rgba(100, 181, 246, .3)","#e57373","rgba(229, 115, 115, .3)"]},legend:null}}},ae=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=[];return void 0!==this.props.clickedGroup&&(e.push({name:"Pinned",type:"Positive",val:this.props.clickedGroup.metrics.p,color:"clickpos"}),e.push({name:"Pinned",type:"Negative",val:this.props.clickedGroup.metrics.n,color:"clickneg"})),void 0!==this.props.hoveredGroup&&(e.push({name:"Hovered",type:"Positive",val:this.props.hoveredGroup.metrics.p,color:"hovpos"}),e.push({name:"Hovered",type:"Negative",val:this.props.hoveredGroup.metrics.n,color:"hovneg"})),r.a.createElement(ee.a,{data:{values:e},spec:te})}}]),t}(n.Component),ne=(a(266),{$schema:"https://vega.github.io/schema/vega-lite/v3.json",width:250,height:50,mark:"bar",transform:[{calculate:"datum.value/100",as:"percent"}],spacing:10,encoding:{row:{field:"metric",type:"ordinal",scale:{padding:4},axis:{title:"",orient:"top",axisWidth:1,offset:-8},header:{titleFontSize:20,labelFontSize:12,labelAngle:0}},y:{field:"group",type:"ordinal",axis:{title:"",labels:!1}},x:{field:"percent",type:"quantitative",scale:{domain:[0,1]},axis:{title:"",format:"%"}},color:{field:"group",type:"nominal",scale:{domain:["hovered","pinned"],range:["#64b5f6","#e57373"]},legend:{title:""}}}}),re=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=[];return this.props.hoveredGroup&&(t=t.concat(this.props.selectedMetrics.map(function(t){return{group:"hovered",metric:t.label,value:e.props.hoveredGroup.metrics[t.value]}}))),this.props.clickedGroup&&(t=t.concat(this.props.selectedMetrics.map(function(t){return{group:"pinned",metric:t.label,value:e.props.clickedGroup.metrics[t.value]}}))),r.a.createElement(ee.a,{data:{values:t},spec:ne})}}]),t}(n.Component),se=a(49),ie=a.n(se),ce={card:{width:"25%",height:"100%",marginTop:70,marginRight:10,overflow:"scroll"},featureStyle:{textAlign:"justify"},avatar:{backgroundColor:"#1D2737"},expand:{margin:"0px auto"},metrics:{marginTop:10},feats:{marginBottom:10},hovered:{color:"#2979ff"},clicked:{color:"#b71c1c"},header:{display:"flex",flexDirection:"inline",justifyContent:"space-between",padding:7,marginBottom:5},selectedGroups:{marginTop:8}},le=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).export=function(){var e=a.props.activeGroups[a.props.clicked];if(e){!function(e,t){var a=document.createElement("a");a.setAttribute("href","data:text/plain;charset=utf-u,"+encodeURIComponent(e)),a.setAttribute("download",t),a.click()}(JSON.stringify(e),"clickedgroup.json")}},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return e.hovered!==this.props.hovered||e.clicked!==this.props.clicked}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.props.activeGroups[this.props.clicked],n=this.props.activeGroups[this.props.hovered],s=[];a&&(s=a.feats,"bottom"===a.type&&(s=a.feats.slice(0,5)));var i=[];n&&(i=n.feats,"bottom"===n.type&&(i=n.feats.slice(0,5)));var c=Object(N.a)(new Set(i.concat(s))).map(function(t,s){var i=r.a.createElement(q.a,null),c=r.a.createElement(q.a,null);return-1!==e.props.clicked&&a.feats.includes(t)&&(c=r.a.createElement(q.a,{align:"right"},a.vals[a.feats.indexOf(t)])),-1!==e.props.hovered&&n.feats.includes(t)&&(i=r.a.createElement(q.a,{align:"right"},n.vals[n.feats.indexOf(t)])),r.a.createElement(r.a.Fragment,null,r.a.createElement(K.a,{key:s},r.a.createElement(q.a,null,t),c,i))});return r.a.createElement(I.a,{className:t.card},r.a.createElement(A.a,null,r.a.createElement("div",{className:t.header},r.a.createElement("h4",{className:t.selectedGroups},"Group Details"),r.a.createElement(m.a,{className:t.exportButton,variant:"contained",color:"secondary",onClick:this.export},"Export")),r.a.createElement(ie.a,null),r.a.createElement(re,{hoveredGroup:n,clickedGroup:a,selectedMetrics:this.props.selectedMetrics}),r.a.createElement(ae,{hoveredGroup:n,clickedGroup:a}),r.a.createElement(U.a,{className:t.feats},r.a.createElement(V.a,{className:t.table,padding:"dense"},r.a.createElement("colgroup",null,r.a.createElement("col",{style:{width:"33%"}}),r.a.createElement("col",{style:{width:"33%"}}),r.a.createElement("col",{style:{width:"33%"}})),r.a.createElement(J.a,{className:t.tableHeader},r.a.createElement(K.a,{key:0},r.a.createElement(q.a,null,"Feature"),r.a.createElement(q.a,{align:"right"},r.a.createElement("span",{className:t.clicked},"Pinned")),r.a.createElement(q.a,{align:"right"},r.a.createElement("span",{className:t.hovered},"Hovered"))),r.a.createElement(K.a,{key:1},r.a.createElement(q.a,null,"Size"),r.a.createElement(q.a,{align:"right"},a&&a.metrics.size),r.a.createElement(q.a,{align:"right"},n&&n.metrics.size))),r.a.createElement(X.a,null,c)))))}}]),t}(n.Component),oe=Object(b.withStyles)(ce)(le),ue=a(84),pe=a.n(ue),de=a(100),he=a.n(de),fe=a(98),me=a.n(fe),ve=a(82),ge=a.n(ve),be=a(66),Ee=a.n(be),ye=a(83),ke=a.n(ye),xe=a(101),Se=a.n(xe),Oe=a(99),je=a.n(Oe),we=a(173),Ce=(a(345),300),Ne=100,Ge=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).update=function(){if("global"===a.props.type)a.drawGlobalDistBar(a.props.dataDistrib,a.props.featName,a.props.featIndex,a.props.maxy);else{var e="click"===a.props.type?a.props.clicked:a.props.hovered;a.drawGroupDistBar(a.props.activeGroups,e,a.props.type,a.props.featName,a.props.featIndex,a.props.maxy)}},a.drawGlobalDistBar=function(e,t,n,r){var s=e[n];a.drawBar(s,n,"global",r)},a.drawGroupDistBar=function(e,t,n,r,s,i){if(j.f("#box-plot-bar-"+n+"-"+s).remove(),t>=0){var c=e[t];if("top"===c.type){var l=c.distrib[s];a.drawBar(l,s,"bar-"+n,i)}}},a.drawBar=function(e,t,n,r){var s=a.node,i=j.f(s).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 300 100").attr("class","box-plot").attr("id","box-plot-"+n+"-"+t).append("g").attr("transform","translate("+a.state.margin.left+","+a.state.margin.top+")"),c=j.d().rangeRound([0,300],.1).domain(e.map(function(e){return e[0]})),l=j.e().range([a.state.height,0]).domain([0,r]),o=a.state.height,u=Object(we.a)().attr("class","d3-tip").offset([-10,0]).html(function(e){return e[0]+": <span style='color:"+P+"'>"+e[1]+"</span>"});i.call(u),i.selectAll("rect").data(e).enter().append("rect").attr("x",function(e){return c(e[0])}).attr("y",function(e){return l(e[1])}).attr("width",function(e){return c.bandwidth()}).attr("height",function(e){return o-l(e[1])}).attr("id",function(e,a){return"rect-"+t+"-"+a}).attr("class","barchart-rect "+n).on("mouseover",u.show).on("mouseout",u.hide)};var n={top:50,right:10,bottom:0,left:10},r=Ce-n.left-n.right,s=Ne-n.top-n.bottom;return a.state={margin:n,width:r,height:s},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return"global"===this.props.type&&0===this.props.dataDistrib.length&&0!==e.dataDistrib.length||("click"===this.props.type&&this.props.clicked!==e.clicked||"hover"===this.props.type&&this.props.hovered!==e.hovered)}},{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{ref:function(t){return e.node=t}})}}]),t}(n.Component),Me={drawer:{width:"20%",flexShrink:0,marginTop:65,maxWidth:360},feature:{margin:10},button:{margin:"0px auto"},listItem:{paddingBottom:"20px",height:100,alignItems:"baseline"},listText:{height:25},radio:{top:"25%"},divider:{marginTop:5},boxLabel:{textTransform:"capitalize",fontSize:"16px",color:"#1D2737",fontWeight:500,margin:0}},ze=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).compareState=function(e,t){if(e.opened.size!==t.opened.size||e.checked.size!==t.checked.size)return!0;var a=!1;return Object.keys(e.subchecked).forEach(function(n){t.subchecked[n].size!==e.subchecked[n].size&&(a=!0)}),a},a.handleToggle=function(e){return function(){var t=a.state.checked,n=new Set(t);n.has(e)?n.delete(e):n.add(e),a.setState({checked:n})}},a.handleSubToggle=function(e,t){return function(){var n=a.state,r=n.subchecked,s=n.checked,i={};Object.keys(r).forEach(function(e){i[e]=new Set(r[e])});var c=new Set(s);i[e].has(t)?i[e].delete(t):i[e].add(t),c.delete(e),a.setState({subchecked:i,checked:c})}},a.handleClick=function(e){return function(){var t=a.state.opened,n=new Set(t);n.has(e)?n.delete(e):n.add(e),a.setState({opened:n})}},a.handleHover=function(e,t){var a="#rect-"+e+"-"+t;j.f(a).style("fill",D).style("opacity",1)},a.handleUnhover=function(e,t){var a="#rect-"+e+"-"+t;j.f(a).style("fill",P).style("opacity",.8)},a.handleClickSubgroup=function(){var e={},t={};a.props.features.forEach(function(n,r){if(a.state.checked.has(r)||a.state.subchecked[r].size>0){var s=[];a.state.subchecked[r].forEach(function(e){s.push(a.props.values[r][e])}),e[n]=s}t[r]=new Set}),a.props.createSubgroups(e),a.setState({checked:new Set,subchecked:t})};var n={},r=[];return e.features.forEach(function(t,a){n[a]=new Set;var s=j.c(e.dataDistrib[a],function(e){return e[1]});r.push(s)}),a.state={checked:new Set,opened:new Set,subchecked:n,features:e.features,max_ys:r},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return!!(0===this.props.features.length&&e.features.length>0||this.props.clicked!==e.clicked||this.props.hovered!==e.hovered||this.compareState(this.state,t))}},{key:"render",value:function(){var e=this,t=this.props.classes,a=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return this.props.features.length>0?r.a.createElement(me.a,{className:t.drawer,classes:{paper:t.drawer},variant:"permanent",anchor:"left"},r.a.createElement(ge.a,null,r.a.createElement(Ee.a,{key:-1},r.a.createElement(je.a,{title:"Create all subgroups of the selected features",placement:"bottom"},r.a.createElement(m.a,{variant:"contained",color:"secondary",className:t.button,onClick:this.handleClickSubgroup},"Generate Subgroups"))),r.a.createElement(ie.a,null),this.props.features.map(function(n,s){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee.a,{key:"section-".concat(s),className:t.listItem,onClick:e.handleClick(s)},r.a.createElement("p",{className:t.boxLabel},n),r.a.createElement(Ge,{featName:n,dataDistrib:e.props.dataDistrib,featIndex:s,type:"global",maxy:e.state.max_ys[s]}),r.a.createElement(Ge,{featName:n,featIndex:s,clicked:e.props.clicked,hovered:e.props.hovered,activeGroups:e.props.activeGroups,type:"hover",maxy:e.state.max_ys[s]}),r.a.createElement(ke.a,{className:t.radio},r.a.createElement(pe.a,{onChange:e.handleToggle(s),checked:e.state.checked.has(s),disabled:e.state.subchecked[s].size>0}))),r.a.createElement(he.a,{in:e.state.opened.has(s),timeout:"auto",unmountOnExit:!0},e.props.values[s].sort(a.compare).map(function(t,a){return r.a.createElement(Ee.a,{key:"item-".concat(s,"-").concat(a),button:!0,onMouseOver:function(t){return e.handleHover(s,a,t)},onMouseOut:function(t){return e.handleUnhover(s,a,t)}},r.a.createElement(Se.a,{primary:t}),r.a.createElement(ke.a,null,r.a.createElement(pe.a,{onChange:e.handleSubToggle(s,a),checked:e.state.subchecked[s].has(a)})))})),r.a.createElement(ie.a,{className:t.divider}))}))):r.a.createElement("div",{className:t.drawer},"Loading...")}}]),t}(n.Component),De=Object(b.withStyles)(Me)(ze),Pe={$schema:"https://vega.github.io/schema/vega-lite/v3.json",height:50,width:75,data:{name:"myData"},transform:[{calculate:"datum.makeup/100",as:"percent"}],mark:"bar",encoding:{y:{field:"value",type:"ordinal",axis:{title:""},sort:{encoding:"x",order:"descending"}},x:{field:"percent",type:"quantitative",axis:{title:"",format:"%"}},color:{field:"primary",type:"nominal",scale:{domain:[0,1],range:["#1D2737","#718C73"]},legend:null}}},Te=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.cluster,a=this.props.feature,n=t.distrib[a],s=this.props.values[this.props.features.indexOf(a)].map(function(t,a){return n[t]?{value:t,makeup:100*n[t],primary:t===e.props.maxVal?1:0}:{value:t,makeup:0,primary:0}});return r.a.createElement(ee.a,{data:{values:s},spec:Pe,style:{paddingLeft:0}})}}]),t}(n.Component),Le=a(175),Be=a.n(Le),Re=a(176),Ie=a.n(Re),Fe=a(59),Ae=a.n(Fe),He=a(48),Ue=a.n(He),We=a(60),Ve=a.n(We);function _e(e,t){var a=[];return t.forEach(function(t){var n=t.feats.length,r=-1;e.feats.forEach(function(a,s){var i=t.feats.indexOf(a);i>=0&&(t.vals[i]===e.vals[s]?n--:r=s)}),1===n&&(t.featDiff=r,a.push(t))}),a}var qe=a(174),$e=(a(387),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).mouseEnter=function(e){a.props.suggestedHover(e)},a.mouseLeave=function(e){a.props.suggestedUnhover(e)},a.mouseClick=function(e){a.props.suggestedClick(e)},a.pageRight=function(){3*a.state.page+4<a.props.clusters.length&&a.setState({page:a.state.page+1})},a.pageLeft=function(){0!==a.state.page&&a.setState({page:a.state.page-1})},a.changeView=function(e){0===e.target.value?a.setState({showSimilar:!1}):-1!==a.props.clicked?a.setState({neighbors:_e(a.props.activeGroups[a.props.clicked],a.props.activeGroups.slice()),showSimilar:!0}):a.setState({showSimilar:!0})},a.changeSort=function(e){a.setState({sort:e.target.value})},a.state={page:0,showSimilar:!1,neighbors:[],sort:"acc"},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e){return e.clicked,this.props.clicked,!!e.clustersLoaded}},{key:"render",value:function(){var e=this,t=this.props.classes;if(this.state.showSimilar&&0!==this.state.neighbors.length){var a=this.props.activeGroups[this.props.clicked],n=this.state.neighbors.sort(function(t,a){return t.metrics[e.state.sort]-a.metrics[e.state.sort]}).map(function(n,s){return r.a.createElement(I.a,{className:"similar-card",key:s,onMouseEnter:function(t){return e.mouseEnter(n)},onMouseLeave:function(t){return e.mouseLeave(n)},onClick:function(t){return e.mouseClick(n)}},r.a.createElement(A.a,{className:t.cardContent},r.a.createElement(V.a,{className:t.table,padding:"dense"},r.a.createElement(X.a,null,r.a.createElement(K.a,null,r.a.createElement(q.a,null,r.a.createElement("b",null," Group ",3*e.state.page+s+1," "),r.a.createElement("br",null),"top"===n.type?"Generated":"Suggested"),r.a.createElement(q.a,null),r.a.createElement(q.a,{align:"right"},n.metrics.size," Instances")))),r.a.createElement(V.a,{className:t.diffTable,padding:"dense"},r.a.createElement(qe.a,null,r.a.createElement(K.a,null,r.a.createElement(q.a,null,"Feature Difference"),r.a.createElement(q.a,{style:{color:"#b71c1c"},align:"right"},"Pinned"),r.a.createElement(q.a,{style:{color:"#718C73"},align:"right"},"Similar"))),r.a.createElement(X.a,null,r.a.createElement(q.a,null,a.feats[n.featDiff]),r.a.createElement(q.a,{align:"right"},a.vals[n.featDiff]),r.a.createElement(q.a,{align:"right"},n.vals[n.feats.indexOf(a.feats[n.featDiff])])))))});return r.a.createElement(U.a,{className:t.paper},r.a.createElement("div",{className:t.header},r.a.createElement(Ae.a,null,r.a.createElement(Ve.a,{value:1,onChange:this.changeView},r.a.createElement(Ue.a,{value:0},"Suggested Subgroups"),r.a.createElement(Ue.a,{value:1},"Similar Subgroups"))),r.a.createElement("div",{className:t.settings},r.a.createElement(x.a,{variant:"body1",className:t.sortText},"Sort by:"),r.a.createElement(Ae.a,null,r.a.createElement(Ve.a,{value:this.state.sort,onChange:this.changeSort},T.map(function(e){return r.a.createElement(Ue.a,{value:e.value},e.label)}))))),r.a.createElement(ie.a,{className:t.headerDivider}),r.a.createElement("div",{className:t.similarGroups},n))}var s=this.props.clusters.filter(function(t){return t.metrics.size>e.props.minSize}).sort(function(t,a){return t.metrics[e.state.sort]-a.metrics[e.state.sort]}).slice(3*this.state.page,3*this.state.page+3).map(function(a,n){return r.a.createElement(I.a,{className:"suggested-card",key:n,onMouseEnter:function(t){return e.mouseEnter(a)},onMouseLeave:function(t){return e.mouseLeave(a)},onClick:function(t){return e.mouseClick(a)}},r.a.createElement(A.a,{className:t.cardContent},r.a.createElement(V.a,{className:t.table,padding:"none"},r.a.createElement(X.a,null,r.a.createElement(K.a,null,r.a.createElement(q.a,{padding:"none",className:t.leftCell},r.a.createElement("b",null,"Group ",3*e.state.page+n+1)),r.a.createElement(q.a,{width:80,padding:"dense",align:"right"},a.metrics.size," Instances")),a.feats.map(function(n,s){return r.a.createElement(K.a,{key:s},r.a.createElement(q.a,{padding:"none",className:t.leftCell},r.a.createElement("b",{className:t.label},n),r.a.createElement("br",null),r.a.createElement("span",{className:t.value},a.vals[s])),r.a.createElement(q.a,{padding:"none",className:t.cell,align:"right"},r.a.createElement(Te,{maxVal:a.vals[s],features:e.props.features,values:e.props.values,cluster:a,feature:n})))})))))});return r.a.createElement(U.a,{className:t.paper},r.a.createElement("div",{className:t.header},r.a.createElement(Ae.a,null,r.a.createElement(Ve.a,{value:0,onChange:this.changeView},r.a.createElement(Ue.a,{value:0},"Suggested Subgroups"),r.a.createElement(Ue.a,{value:1},"Similar Subgroups"))),r.a.createElement("div",{className:t.settings},r.a.createElement(x.a,{variant:"body1",className:t.sortText},"Sort by:"),r.a.createElement(Ae.a,null,r.a.createElement(Ve.a,{value:this.state.sort,onChange:this.changeSort},T.map(function(e){return r.a.createElement(Ue.a,{value:e.value},e.label)}))),r.a.createElement("div",{className:t.paging},r.a.createElement(Be.a,{onClick:this.pageLeft}),r.a.createElement(x.a,{variant:"body1"},3*this.state.page+1," -"," ",3*this.state.page+3>this.props.clusters.length?this.props.clusters.length:3*this.state.page+3),r.a.createElement(Ie.a,{onClick:this.pageRight})))),r.a.createElement(ie.a,{className:t.headerDivider}),r.a.createElement("div",{className:t.cards},s))}}]),t}(n.Component)),Je=Object(b.withStyles)({paper:{height:350,overflow:"scroll",marginLeft:20,marginRight:20,marginTop:30},metrics:{display:"flex",flexDirection:"inline",justifyContent:"space-between",padding:7},header:{display:"flex",flexDirection:"inline",justifyContent:"space-between",padding:7},cards:{display:"flex",flexDirection:"inline",justifyItems:"center"},cardContent:{padding:0},divider:{marginTop:10,marginBottom:10},headerDivider:{marginBottom:7},table:{width:"100%"},fab:{float:"right"},paging:{float:"right",display:"inline-flex",marginTop:7,justifyContent:"center"},label:{textTransform:"capitalize"},value:{color:"#718C73"},similarGroups:{display:"inline-flex",flexWrap:"wrap",justifyContent:"center"},settings:{display:"inline-flex"},sortText:{marginRight:13,marginTop:7},diffTable:{marginTop:10},leftCell:{paddingLeft:"10px",maxWidth:50}})($e),Ye=a(109),Ke=a(177),Qe=a(185),Xe=a(9),Ze=a.n(Xe),et=a(184),tt=a(102),at=a.n(tt),nt=a(103),rt=a.n(nt),st=a(178),it=a.n(st),ct=a(52);function lt(e){var t=e.inputRef,a=Object(Qe.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))}var ot={Control:function(e){return r.a.createElement(at.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:lt,inputProps:Object(Ke.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))},Menu:function(e){return r.a.createElement(U.a,Object.assign({square:!0,className:e.selectProps.classes.paper},e.innerProps),e.children)},MultiValue:function(e){return r.a.createElement(rt.a,{tabIndex:-1,label:e.children,className:Ze()(e.selectProps.classes.chip,Object(Ye.a)({},e.selectProps.classes.chipFocused,e.isFocused)),onDelete:e.removeProps.onClick,deleteIcon:r.a.createElement(it.a,e.removeProps)})},NoOptionsMessage:function(e){return r.a.createElement(x.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.noOptionsMessage},e.innerProps),e.children)},Option:function(e){return r.a.createElement(Ue.a,Object.assign({buttonRef:e.innerRef,selected:e.isFocused,component:"div",style:{fontWeight:e.isSelected?500:400}},e.innerProps),e.children)},Placeholder:function(e){return r.a.createElement(x.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},ValueContainer:function(e){return r.a.createElement("div",{className:e.selectProps.classes.valueContainer},e.children)}},ut=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(o.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).handleChange=function(e){a.props.onMetricChange(e)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.selectedMetrics,t=this.props.suggestions;return r.a.createElement("div",{className:this.props.classes.selectorWrapper},r.a.createElement(et.a,{classes:this.props.classes,options:t,components:ot,onChange:this.handleChange,value:e,placeholder:"Select Fairness Metrics",isMulti:!0}))}}]),t}(n.Component),pt=Object(b.withStyles)(function(e){return{selectorWrapper:{minWidth:250,color:"white",marginRight:20,marginTop:10},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},chip:{margin:"".concat(e.spacing.unit/2,"px ").concat(e.spacing.unit/4,"px")},chipFocused:{backgroundColor:Object(ct.emphasize)("light"===e.palette.type?e.palette.grey[300]:e.palette.grey[700],.08)},noOptionsMessage:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},placeholder:{position:"absolute",left:2,fontSize:16},paper:{position:"absolute",zIndex:1,marginTop:e.spacing.unit,left:0,right:0},divider:{height:2*e.spacing.unit}}})(ut),dt=(a(417),function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).createStripPlot=function(){var e=a.node;j.f(e).selectAll("svg").remove(),a.props.selectedMetrics.forEach(function(t){j.f(e).append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 1000 105").attr("id","stripplot-"+t.value).append("g").attr("transform","translate("+a.state.margin.left+","+a.state.margin.top+")").append("g").attr("class","x axis").attr("transform","translate(0,"+a.state.height+")").call(a.state.xAxis).append("text").text(t.label).attr("class","axis-label").attr("x",-10).attr("y",-10)}),a.update()},a.update=function(){a.props.selectedMetrics.forEach(function(e){var t=j.f(a.node).select("#stripplot-"+e.value);t.selectAll(".percentline").remove(),t.selectAll(".percentline").data(a.props.activeGroups,function(e){return e.id}).enter().append("line").filter(function(e){return e.metrics.size>a.props.minSize}).attr("x1",function(t){return a.state.xScale(t.metrics[e.value])+50}).attr("x2",function(t){return a.state.xScale(t.metrics[e.value])+50}).attr("y1",30).attr("y2",80).attr("class","percentline").attr("id",function(e){return"linecluster"+e.id}).on("mouseover",function(e){a.props.barHover(e.id)}).on("mouseout",function(e){a.props.barHover(-1)}).on("click",function(e){a.props.barClick(e.id)}),delete a.props.avgs.size;var n=t.selectAll("line.avg").data(a.props.avgs).enter().append("g");n.append("line").attr("x1",function(t){return a.state.xScale(t[e.value])+50}).attr("x2",function(t){return a.state.xScale(t[e.value])+50}).attr("y1",20).attr("y2",90).style("stroke","#5a6d94").style("stroke-width",2).style("opacity",.4),n.append("text").text(function(t){return"avg: "+t[e.value].toFixed(2)+"%"}).attr("text-anchor","middle").attr("x",function(t){return a.state.xScale(t[e.value])+50}).attr("y",15).attr("font-family","sans-serif").attr("font-size","12px").attr("fill","#5a6d94")})};var n={top:0,right:50,bottom:0,left:50},r=j.e().range([0,1e3-n.right-n.left]).domain([0,100]),s=j.e().range([80-n.top-n.bottom,0]).domain([0,100]),i=j.a().scale(r).tickPadding(8).ticks(8).tickFormat(function(e){return 1*e+"%"});return a.state={margin:n,width:1e3-n.left-n.right,height:80-n.top-n.bottom,xScale:r,yScale:s,xAxis:i},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.createStripPlot()}},{key:"shouldComponentUpdate",value:function(e,t){return e.minSize!==this.props.minSize||(e.selectedMetrics.length!==this.props.selectedMetrics.length||e.activeGroups.length!==this.props.activeGroups.length)}},{key:"componentDidUpdate",value:function(e,t){e.selectedMetrics.length!==this.props.selectedMetrics.length&&this.createStripPlot()}},{key:"render",value:function(){var e=this;return this.update(),r.a.createElement("div",{className:this.props.classes.plot,ref:function(t){return e.node=t}})}}]),t}(n.Component)),ht=Object(b.withStyles)({plot:{display:"inline-block",minWidth:500,width:"100%"}})(dt),ft=Object(b.createMuiTheme)({palette:{primary:{main:"#1D2737"},secondary:{main:D}},overrides:{MuiSlider:{thumb:{backgroundColor:"#EBEBEB"},track:{backgroundColor:"#EBEBEB"}}}}),mt={appBar:{zIndex:1},body:{display:"flex",flexDirection:"inline"},content:{width:"55%",display:"flex",flexDirection:"column",marginTop:65,marginLeft:10},plot:{width:"100%"},slider:{width:150,padding:20,marginRight:30},reset:{float:"right"},title:{flexGrow:1},subtitle:{flexGrow:1,color:P,textAlign:"center"},loadingScreen:{minWidth:"100%",minHeight:"calc(100% + 22px)",marginTop:-22,backgroundColor:"#1D2737",margin:"0px auto"},loadingText:{paddingTop:150,color:"white",textAlign:"center"},loadingProgress:{display:"block",marginLeft:"auto",marginRight:"auto",color:"white"}},vt=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).createSubgroups=function(e){var t=G(a.state.data,e,a.state.activeGroups.length,a.state.features,a.state.values);a.setState({activeGroups:a.state.activeGroups.concat(t)})},a.suggestedHover=function(e){j.g(".linehover").classed("linehover",!1);var t=a.state.activeGroups.filter(function(t){return t.clusterid===e.clusterid});0===t.length?(e.id=a.state.activeGroups.length,a.setState({activeGroups:a.state.activeGroups.concat(e),hovered:e.id},function(){j.g("#linecluster"+e.id).classed("linehover",!0),j.g("#linecluster"+a.state.clicked).classed("lineclick",!0)})):(j.g("#linecluster"+t[0].id).classed("linehover",!0),a.setState({hovered:t[0].id},function(){j.g("#linecluster"+a.state.clicked).classed("lineclick",!0)}))},a.suggestedUnhover=function(e){j.g(".linehover").classed("linehover",!1);var t=a.state.activeGroups.filter(function(t){return t.id===a.state.clicked||t.clusterid!==e.clusterid});a.setState({activeGroups:t,hovered:-1},function(){j.g("#linecluster"+a.state.clicked).classed("lineclick",!0)})},a.suggestedClick=function(e){j.g(".lineclick").classed("lineclick",!1);var t=a.state.activeGroups.filter(function(t){return t.clusterid===e.clusterid});0===t.length?(e.id=a.state.activeGroups.length,a.setState({activeGroups:a.state.activeGroups.concat(e),clicked:e.id},function(){j.g("#linecluster"+e.id).classed("lineclick",!0)})):(j.g("#linecluster"+t[0].id).classed("lineclick",!0),a.setState({clicked:t[0].id}))},a.barHover=function(e){j.g(".linehover").classed("linehover",!1),j.g("#linecluster"+e).classed("linehover",!0),a.setState({hovered:e})},a.barClick=function(e){j.g(".lineclick").classed("lineclick",!1),j.g("#linecluster"+e).classed("lineclick",!0),a.setState({clicked:e})},a.changeMinSize=function(e,t){a.setState({minSize:t})},a.resetGroups=function(){a.setState({hovered:-1,clicked:-1,minSize:0,activeGroups:[]})},a.handleMetricsChange=function(e){a.setState({selectedMetrics:e})},a.state={data:[],dataDistrib:{},clusters:[],activeGroups:[],avgs:[],features:[],values:[],hovered:-1,clicked:-1,selectedMetrics:T.slice(0,3),minSize:0,dataLoaded:!1,clustersLoaded:!1};var n=new B(L);return n.addEventListener("message",function(e){var t=e.data,n=z(t.data,t.feats,t.vals);a.setState({data:t.data,dataDistrib:t.distrib,avgs:[t.avgs],features:t.feats,values:t.vals,clusters:n,dataLoaded:!0,clustersLoaded:!0})}),j.b(C.a).then(function(e){return n.postMessage(e)}),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.classes;return this.state.dataLoaded?r.a.createElement(b.MuiThemeProvider,{theme:ft},r.a.createElement(h.a,{position:"fixed",className:e.appBar},r.a.createElement(y.a,null,r.a.createElement(x.a,{inline:!0,variant:"h4",color:"inherit",className:e.title},r.a.createElement("strong",null,"FairVis")," ",r.a.createElement(x.a,{inline:!0,variant:"h6",className:e.subtitle}," ","Audit Classification for Intersectional Bias"," ")),r.a.createElement(x.a,{variant:"body1",color:"inherit"},"Minimum Size: ",this.state.minSize),r.a.createElement(O.a,{className:e.slider,value:this.state.minSize,onChange:this.changeMinSize,step:1,min:0,max:0===this.state.activeGroups.length?0:j.c(this.state.activeGroups,function(e){return e.metrics.size})}),r.a.createElement(m.a,{className:e.reset,variant:"contained",color:"secondary",onClick:this.resetGroups},"Reset Groups"))),r.a.createElement("div",{className:e.body},r.a.createElement(De,{features:this.state.features,values:this.state.values,createSubgroups:this.createSubgroups,dataDistrib:this.state.dataDistrib,dataLoaded:this.state.dataLoaded,hovered:this.state.hovered,clicked:this.state.clicked,activeGroups:this.state.activeGroups}),r.a.createElement("div",{className:e.content},r.a.createElement(pt,{className:e.metricSelector,onMetricChange:this.handleMetricsChange,suggestions:T,selectedMetrics:this.state.selectedMetrics}),r.a.createElement("div",{className:e.plot},r.a.createElement(ht,{activeGroups:this.state.activeGroups,avgs:this.state.avgs,barHover:this.barHover,barClick:this.barClick,minSize:this.state.minSize,selectedMetrics:this.state.selectedMetrics})),r.a.createElement(Je,{clusters:this.state.clusters,minSize:this.state.minSize,suggestedHover:this.suggestedHover,suggestedUnhover:this.suggestedUnhover,suggestedClick:this.suggestedClick,clustersLoaded:this.state.clustersLoaded,features:this.state.features,values:this.state.values,clicked:this.state.clicked,activeGroups:this.state.activeGroups})),r.a.createElement(oe,{hovered:this.state.hovered,clicked:this.state.clicked,activeGroups:this.state.activeGroups,selectedMetrics:this.state.selectedMetrics,clusters:this.state.clusters}))):r.a.createElement("div",{className:e.loadingScreen},r.a.createElement(x.a,{variant:"h2",color:"inherit",className:e.loadingText},r.a.createElement("strong",null,"FairVis")," "),r.a.createElement(x.a,{variant:"h6",className:e.subtitle},"Audit Classification for Intersectional Bias"),r.a.createElement("h3",{className:e.loadingText},"Loading data"),r.a.createElement(g.a,{color:"primary",className:e.loadingProgress}))}}]),t}(n.Component),gt=Object(b.withStyles)(mt)(vt);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(gt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[245,1,2]]]);
//# sourceMappingURL=main.b5266b90.chunk.js.map